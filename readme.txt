ПК "СПРАВОЧНИК БИК"

Назначение: Получение справочной информации об участниках электронных расчетов - 
            клиентов МЦОИ (Межрегионального центра обработки информации).

Системные требования: Windows XP-10 всех разрядностей. Аппаратные - минимальные (см. требования к MS Visual Foxpro 9.0 SP2).

Лицензия: Бесплатно.

Описание работы:

 Программа загружает из XML-файла ГГГГММДД_ED807_full.xml (описан в документации УФЭБС ЦБ РФ) данные о клиентах МЦОИ
и их счетах. Скачивает с сайта cbr.ru за указанную дату (например: http://www.cbr.ru/VFS/mcirabis/BIKNew/)
или из локальной папки Data ранее скачанные. Заполняет dbf-таблицы (курсоры MS Visual Foxpro). 
Таблица БИК связана с таблицей счетов по первичному ключу по БИК. Поиск в таблице БИК инициируется по клавише F5 
или нажатием правой кнопки мыши (вызывается контекстное меню). В зависимости от выбранного столбца вызывается 
соответствующая форма поиска (по БИК, по Наименованию, по УИС, по БИК (СВИФТ), по Индексу, по Рег. №). 
Также в контекстном меню присутствуют и др. пункты (просмотр, отбор по фильтру, сброс фильтра, копирование 
значения ячейки в буфер обмена, сравнить с датой). Контекстное меню есть также во всех формах поиска и фильтрации. 
На поле ввода также по нажатию правой кнопки мыши можно вставить скопированное ранее значение (или по клавишам Ctrl+V).
 Реализована сортировка по двойному клику на заголовок (название) столбца для выделенных жирным шрифтом. 
Отбор по фильтру позволяет отфильтровать записи по атрибутам: Наименование участника, Наим. нас. п., Адрес, Код тер.,
Тип участника перевода, Наименование участника на английском яз.. и др.
 Из п. меню "Просмотр" формируется временная таблица для показа одной записи таблицы БИК и привязанных к ней счетов 
(по правой кнопке мыши эта информация выводится в текстовый файл и открывается в блокноте).
 По клавише F6 ведется поиск по счету в таблице счетов. По F7 можно сохранить dbf-файлы для последующего мгновенного
открытия. По правой кнопке мыши на таблице счетов тоже появляется контекстное меню. По F1 вызывается этот файл. 
В настроечном ini-файле (sprav807.INI) указан адрес откуда скачиваются обновления справочника (переменная URL1), переменная 
AutoSave имеет 2 значения: YES и NO. Если AutoSave=YES, то при открытии таблиц (на 2-й форме) происходит автоматическое 
сохранение DBF-файлов для последующего быстрого открытия, переменная NumberButton имеет три значения: 1 или 2 или 3. 
Если NumberButton=1, то при запуске программы автоматически выбирается (на первой форме) первый пункт радиокнопок 
(загрузка с сайта cbr.ru), если NumberButton=2, то - второй пункт (загрузка XML из локальной папки Data), если NumberButton=3, 
то выбирается третий пункт (открытие ранее сохраненных DBF - файлов). При запуске первой формы или ввода даты на ней 
происходит проверка наличия ранее сохранённых dbf-файлов. Если они найдены, то надпись "Импорт" на кнопке становится 
зелёного цвета, если их нет - оранжевого. Переменная AfterDays в секции [ClearHistory] определяет значение в днях, старше 
которого будут удаляться файлы данных из папки Data и ZIP.

Замечания и предложения на alex2sign@yandex.ru 

С наилучшими пожеланиями Истраков Александр.
----------------------------------------------------------
30.11.2018
Реализована функция сравнения двух дат справочника БИК (из контекстного меню).
Если предварительно установить фильтер в открытом справочнике, то фильтер переходит и на сравнимаемую дату.
----------------------------------------------------------
15.12.2018
Реализован экспорт в bnkseek.dbf (по F7). Если AutoSave=YES в ini-файле, то экспорт в bnkseek.dbf происходит автоматически.

----------------------------------------------------------
08.01.2019
Реализован вывод списка участников в файл (если есть фильтр, то сведения о нём выводятся).

----------------------------------------------------------
11.01.2019
За дату 03.01.2019 xml-файл справочника с ошибкой.
В xml-файле нужно удалить в самом начале строку: <?xml version="1.0" encoding="WINDOWS-1251"?>
 и сохранить. 

----------------------------------------------------------
